======================================================================
【タイトル】 KTrans ver.0.17
【ファイル】 ktrans017.lzh
【更新日付】 2004/02/28
【制 作 者】 yasu
【動作環境】 Windows98,2k,XP A3012CA,A5303H,A5403CAで確認
【配布形態】 フリーウェア
【 E-Mail 】 mail@yasu.hot.co.jp
【HomePage】 http://www3.to/yasu/ http://yasu.rank.nu/ez/
【再 配 布】 基本的に禁止。ホームページを紹介して下さい。
【著 作 権】 Copyright(C)2003 Yasu software
======================================================================

■ KTrans の紹介

　このソフトは、auの携帯電話とパソコンをシリアルケーブルで接続すること
で、ファイルを転送可能にするソフトです。市販の一部のソフトでは、すべて
のファイルを転送するようになっていますが、このソフトはファイル一覧を表
示し、必要なファイルのみ転送する設計になっています。
　なお、このソフトウェアは非公式に通信方法を解析して作成したものなので
正しく動作しない可能性があります。また、メモリが破壊される恐れもありま
す。動作に関して一切無保証ですし、不具合が起こっても責任は負えません。
その点を理解できる場合のみご利用下さい。質を求めるなら有償のものが良い
ですよ(￣ー￣)

・動作確認済み機器
携帯端末：A3012CA,A5303H,A5403CA
ケーブル：MySync付属シリアル, SUNTAC U-Cable typeA2,
　　　　　A5403CA用USBクレードル
・動作報告済み機種
携帯端末：A5305K,A5401CA,A5302CA,A5303H2,A3011SA,
　　　　　A1301S,A1101S,A1012K,C5001T,C3003P,C404S
ケーブル：MySync専用USB, IO-DATA USB-cdma, 携快電話8付属品, 9-CDM

※動作の保証はできません


■ 初期設定

　まず、画面左上でCOMポートを指定して下さい。選択肢に無い場合は、入力
して下さい。

・シリアルケーブルの場合
ケーブルを接続したポートを指定して下さい。

・モデム付きUSBケーブルの場合
コントロールパネルのモデムより、該当するケーブルのプロパティを表示し、
確認して下さい。

・その他のUSBケーブルの場合
コントロールパネルのシステムで、ハードウェア→デバイスマネージャを表示
し、ポート(COM,LPT)より確認して下さい。

次に、ポートの横のコンボボックスよりケーブルの種類(ATコマンド)を指定し
て下さい。

・シリアルケーブルやモデム機能のないUSBケーブルの場合
空欄にするか、Serialを選択して下さい。

・モデム付きUSBケーブルの場合
使用するケーブルのATコマンドを入力して下さい。
Modem1を選択すると AT%Z
Modem2を選択すると ATZ
Modem3を選択すると ATZ80
コマンドを指定したことになります。

　携帯端末ごとに、BaudRate及びFrameSizeを指定する必要があります。横の
コンボボックスから機種を選べば、その機種向けのBaudRate及びFrameSizeが
自動的に指定されます。手動で指定するには、その横の２つの入力ボックスに
それぞれ左からBaudRate、FrameSizeの値を入力して下さい。


■ 基本的な使用方法

　画面右中のコンボボックスより行いたいタスクを追加し、Connectボタンで
実際に通信が行われます。通信を中断したい場合は、Disconnectボタンを押し
て下さい。追加したタスクは、タスクリスト上のボタンで移動・削除ができま
す。ダブルクリックして削除する事もできます。GetTelephoneNumberと
GetLockNumberは移動できません。

・GetTelephoneNumber
携帯端末の電話番号を表示します
・SearchLockNumber
携帯端末のロック番号を検索します。１万通りアタックしますので、時間がか
かります。番号を忘れた場合などにご利用下さい。各桁を1,2,…,9,0と変化さ
せ、1111,1112,…と検索します。どうやらセキュリティコードにもヒットする
みたい？
・GetProfile
携帯端末の情報を取得します
・GetFileList
携帯端末のファイル一覧を取得します
・GetFile
ファイル一覧から選んだファイルを携帯端末から取得します。著作権つきのフ
ァイルなどは取得できません(端末が拒否します)。ファイル一覧でダブルクリ
ックしても登録できます。
・GetFile(InputFileName)
入力したファイル名のファイルを携帯端末から取得します
・PutFile
パソコンのファイルを携帯端末へ送信します。同名ファイルが存在した場合の
動作は端末によります。KTransのウィンドウにファイルをドロップしても登録
可能です
・DelFile
ファイル一覧から選んだファイルを携帯端末から削除します
・DelFile(InputFileName)
入力したファイル名のファイルを携帯端末から削除します

各リストは、CTRLやSHIFTを押しながら選択することで複数選択可能です。


■ 詳細設定

KTrans.iniを開き、[KTrans]下の下記項目の値を変えることで、詳細な値を変
更できます。

WaitFirst=500	; COMポートを開いてからのウェイト
WaitAT=500	; ATコマンド後のウェイト(この間来た物は無視)
WaitBaud=500	; SetBaudRate実行後のウェイト
WaitCmd=500	; コマンド失敗時の再送信までのウェイト
WaitTask=100	; タスク間のウェイト
TimeOut=2500	; コマンド失敗判定時間
RI=500		; ReadIntervalTimeout
RM=10		; ReadTotalTimeoutMultiplier
RC=5000		; ReadTotalTimeoutConstant
WM=100		; WriteTotalTimeoutMultiplier
WC=5000		; WriteTotalTimeoutConstant


■ 既知のバグ(仕様？)

・たまにThread Startedのまま動かなくなるらしい？
・モード移行失敗(08)エラーがでて移行できない
　→ GetTelephoneNumberを追加しておくとできる場合があるらしい
・SetFrameSize失敗
　→ SetBaudRateがうまくいっていない模様。
　　 BaudRateを9600などに下げるといけるかも？但し激遅
・通信モード設定に失敗する
　→ ケーブルがモデム機能を有していないのにModemを選んでいませんか？
　　 モデム機能がない場合は,Serialを選ぶ必要があります。
・転送失敗して携帯がダイヤルモード(や待受以外)になった
　→ 使用を中止したほうが良いです。メモリが破壊される恐れがあります


■ デバッグについて

KTrans.iniの[KTrans]の次の行に

Debug=1

という行を加えてから起動して通信すると、exeと同じファイル名のlogファイ
ルが作成されます。このファイルには、最後に行ったConnectからDisconnect
までの通信内容が記録されています。

うまく動かない場合、機種やケーブルや各種設定と共にこのファイルを送って
下されば、できる限りこちらで調べさせて頂きます。但し、必ず対応できると
は限りません。
※GetTelephoneNumberを行った時の通信記録の場合、携帯端末の電話番号が記
録されている可能性があります。最初のほうの、9A 99 9A 又は 9A 98 9A 〜
AAまでが電話番号です。削除するなど、送って下さる場合はご注意下さい。


■ アンインストール

　設定はexeと同じファイル名のiniに保存しています。解凍したファイル群と
一緒に削除して下さい。


■ その他

　感想・バグ・要望などがあったらホームページもしくはメールでお知らせく
ださい。バグ報告の場合は、どのようにしたらどのようになるかをなるべく詳
しくお願いします。また、バグ等で不具合が起こったとしても責任は負いかね
ます。
　このソフトをホームページなどで紹介する場合は、作者にメールで知らせて
ください（ファイルの転載は禁止。ホームページへのリンクだけの場合は連絡
不要です）。知人に紹介する場合は、ファイルの再配布はせず、ホームページ
を紹介するようお願いします。
　このソフトはau(KDDI),MySync(CASIO)ならびに各端末の製作元とは関係あり
ません。独自に開発したものです。このソフトに関して、それぞれの会社へ問
い合わせしないで下さい。


■ 更新履歴

□ 2004/02/28 ver.0.17
・GetFileしたファイルのタイムスタンプを携帯側と同じに設定
・GetFileInfoのDateの後ろにゴミがでるの修正
・ATコマンドを入力可能にした

□ 2004/01/15 ver.0.16
・GetProfileで機種名を正しく取得できないバグ修正
・機種情報追加

□ 2003/11/10 ver.0.15
・注意事項追記
・機種情報追加

□ 2003/08/31 ver.0.15
・SetBaudRate失敗時は下げて再試行
・GetProfile(0000h)でタイプ数が2以外に対応

□ 2003/08/30 ver.0.14
・SearchLockNumberを最後まで終了しないようにした
・SearchLockNumberをプログレス表示
・ボーレート設定失敗時にデバッグログ追加
・ファイルリストのカラム幅保存
・ファイルリストにアイコンつけてみたり

□ 2003/08/24 ver.0.13
・失敗時再送信のバグ修正

□ 2003/07/30 ver.0.12
・未対応だった応答の１つに対応
・ウェイト１つ追加
・DelFile(InputFileName)
・SetFrameSize失敗時は256まで/2ずつ試行

□ 2003/07/25 ver.0.11
・プログレスバーをつけた
・ウェイト値をiniから取得
・細かい所修正

□ 2003/07/22 ver.0.1
・やっとプロトコルがわかってきたので作成

